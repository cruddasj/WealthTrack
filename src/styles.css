@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light;
    --canvas: #f3f4f6;
    --surface: #ffffff;
    --surface-50: #f1f5f9;
    --surface-200: #e5e7eb;
    --body: #111827;
    --accent: #10b981;
    --accent-strong: #059669;
    --accent-soft: rgba(16, 185, 129, 0.15);
    --error: #dc2626;
    --card-bg: #ffffff;
    --card-border: #e5e7eb;
    --card-filter: none;
    --card-shadow: none;
  }

  html {
    height: 100%;
    scroll-behavior: smooth;
  }

  body {
    min-height: 100%;
    font-family: 'Inter', sans-serif;
    background: var(--canvas);
    color: var(--body);
  }

  body.mobile-nav-open {
    overflow: hidden;
  }

  #mobileHeader {
    position: sticky;
    top: 0;
    z-index: 40;
    background-color: inherit;
  }

  body.mobile-header-static #mobileHeader {
    position: static;
    top: auto;
    z-index: auto;
  }

  body.mobile-nav-open #mobileHeader {
    opacity: 0;
    pointer-events: none;
  }

  html.dark {
    color-scheme: dark;
    --canvas: #0f172a;
    --surface: #111827;
    --surface-50: rgba(15, 23, 42, 0.75);
    --surface-200: #374151;
    --body: #f9fafb;
    --accent-soft: rgba(16, 185, 129, 0.25);
    --error: #fca5a5;
    --card-bg: #1f2937;
    --card-border: #374151;
  }

  html.theme-inverted:not(.dark) body {
    background: linear-gradient(180deg, #1f2937, #111827);
  }

  html.theme-inverted.dark body {
    background: linear-gradient(180deg, #f8fafc, #eef2ff);
  }

  html.theme-inverted .sidebar-panel {
    background-color: #ffffff;
    border-color: #e5e7eb;
    color: #1f2937;
  }

  html.theme-inverted.dark .sidebar-panel {
    background-color: #1f2937;
    border-color: #374151;
    color: #f9fafb;
  }

  html.theme-glass:not(.dark) {
    --card-bg: rgba(255, 255, 255, 0.25);
    --card-border: rgba(255, 255, 255, 0.4);
    --card-filter: blur(20px) saturate(180%);
    --card-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
  }

  html.theme-glass.dark {
    --card-bg: rgba(17, 24, 39, 0.4);
    --card-border: rgba(255, 255, 255, 0.15);
    --card-filter: blur(20px) saturate(180%);
    --card-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
  }

  html.theme-glass:not(.dark) body {
    background: linear-gradient(135deg, #e6e9ec, #cfd5df);
  }

  html.theme-glass.dark body {
    background: linear-gradient(10deg, #374151, #111827);
  }
}

@layer components {
  .card {
    @apply rounded-2xl border px-6 py-6 transition-colors duration-200;
    background-color: var(--card-bg);
    border-color: var(--card-border);
    backdrop-filter: var(--card-filter);
    -webkit-backdrop-filter: var(--card-filter);
    box-shadow: var(--card-shadow);
  }

  .card-body {
    @apply mt-4;
  }

  .sidebar-panel {
    background-color: var(--card-bg);
    border-color: var(--card-border);
    backdrop-filter: var(--card-filter);
    -webkit-backdrop-filter: var(--card-filter);
    box-shadow: var(--card-shadow);
  }

  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 font-semibold shadow-md transition-colors duration-300;
  }

  .btn:disabled {
    @apply cursor-not-allowed opacity-50;
  }

  .btn.loading {
    cursor: progress;
  }

  .btn:focus-visible {
    outline: 2px solid rgba(16, 185, 129, 0.45);
    outline-offset: 3px;
  }

  .btn-green {
    @apply bg-green-500 text-white hover:bg-green-600;
  }

  .btn-blue {
    @apply bg-blue-500 text-white hover:bg-blue-600;
  }

  .btn-purple {
    @apply bg-purple-600 text-white hover:bg-purple-700;
  }

  .btn-gray {
    @apply bg-gray-300 text-gray-800 hover:bg-gray-400 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500;
  }

  .btn-red {
    @apply bg-red-500 text-white hover:bg-red-600;
  }

  .nav-btn {
    @apply mb-2 flex w-full items-center gap-3 rounded-lg px-4 py-3 text-left font-medium text-gray-500 transition duration-300;
    background-color: transparent;
  }

  .dark .nav-btn {
    @apply text-gray-400;
  }

  .nav-btn:hover {
    @apply bg-gray-200;
  }

  .dark .nav-btn:hover {
    @apply bg-gray-700;
  }

  .nav-btn.active {
    @apply bg-gray-900 text-gray-100;
  }

  .dark .nav-btn.active {
    @apply bg-gray-100 text-gray-900;
  }

  .nav-btn:focus-visible {
    outline: 2px solid rgba(16, 185, 129, 0.4);
    outline-offset: 3px;
  }

  .nav-icon {
    @apply flex h-5 w-5 flex-none items-center justify-center text-base leading-none;
  }

  .dark-mode-toggle {
    display: flex;
    align-items: center;
    cursor: pointer;
    user-select: none;
  }

  .dark-mode-toggle__text {
    @apply text-sm font-semibold text-gray-500 dark:text-gray-400;
  }

  .dark-mode-toggle input[type='checkbox'] {
    display: none;
  }

  .dark-mode-toggle .toggle-track {
    display: inline-block;
    flex-shrink: 0;
    width: 56px;
    height: 28px;
    background-color: #d1d5db;
    border-radius: 9999px;
    position: relative;
    transition: background-color 0.3s ease;
  }

  .dark .dark-mode-toggle .toggle-track {
    background-color: #4b5563;
  }

  .dark-mode-toggle input[type='checkbox']:checked + .toggle-track {
    background-color: #10b981;
  }

  .dark-mode-toggle .toggle-thumb {
    width: 24px;
    height: 24px;
    background-color: #ffffff;
    border-radius: 9999px;
    position: absolute;
    top: 2px;
    left: 2px;
    transition: transform 0.3s ease;
  }

  .dark-mode-toggle input[type='checkbox']:checked + .toggle-track .toggle-thumb {
    transform: translateX(28px);
  }

  .form-label {
    @apply mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300;
  }

  .input-field {
    @apply w-full rounded-lg border border-gray-200 bg-gray-100 px-3 py-2 text-gray-900 shadow-sm transition focus:outline-none focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100;
  }

  input[type='date'].input-field {
    @apply pr-3;
  }

  input[type='date'].input-field::-webkit-calendar-picker-indicator {
    cursor: pointer;
    filter: invert(35%);
    opacity: 0.85;
  }

  .dark input[type='date'].input-field::-webkit-calendar-picker-indicator {
    filter: invert(80%);
    opacity: 0.9;
  }

  .changelog-entry {
    @apply rounded-2xl border px-4 py-4 transition-colors duration-150 md:px-6 md:py-5;
    background-color: color-mix(in srgb, var(--surface) 90%, transparent);
    border-color: color-mix(in srgb, var(--surface-200) 80%, transparent);
  }

  .changelog-entry__header {
    @apply flex flex-wrap items-baseline justify-between gap-2;
  }

  .changelog-accordion {
    @apply rounded-2xl border transition-colors duration-150;
    background-color: color-mix(in srgb, var(--surface) 90%, transparent);
    border-color: color-mix(in srgb, var(--surface-200) 80%, transparent);
  }

  .changelog-accordion__summary {
    @apply flex cursor-pointer items-center justify-between gap-3 px-4 py-4 md:px-6 md:py-5;
    list-style: none;
  }

  .changelog-accordion__summary:focus-visible {
    outline: 2px solid color-mix(in srgb, var(--accent) 40%, transparent);
    outline-offset: 3px;
  }

  .changelog-accordion__summary::-webkit-details-marker {
    display: none;
  }

  .changelog-accordion__header {
    @apply flex flex-wrap items-baseline gap-2;
  }

  .changelog-accordion__title {
    @apply text-base font-semibold text-body;
  }

  .changelog-accordion__date {
    @apply text-sm text-body/60;
  }

  .changelog-accordion__icon {
    color: color-mix(in srgb, var(--body) 50%, transparent);
    transition: transform 0.2s ease;
  }

  .changelog-accordion[open] .changelog-accordion__icon {
    @apply text-accent;
    transform: rotate(180deg);
  }

  .changelog-accordion__content {
    @apply border-t px-4 pb-4 pt-3 md:px-6 md:pb-6 md:pt-4;
    border-color: color-mix(in srgb, var(--surface-200) 70%, transparent);
    background-color: color-mix(in srgb, var(--surface-50) 40%, transparent);
  }
}

@layer utilities {
  .bg-surface {
    background-color: var(--surface);
  }

  .bg-surface-50\/70 {
    background-color: color-mix(in srgb, var(--surface-50) 70%, transparent);
  }

  .bg-surface-muted {
    background-color: color-mix(in srgb, var(--surface-50) 55%, transparent);
  }

  .border-surface-200 {
    border-color: var(--surface-200);
  }

  .text-body {
    color: var(--body);
  }

  .text-body\/80 {
    color: color-mix(in srgb, var(--body) 80%, transparent);
  }

  .text-body\/70 {
    color: color-mix(in srgb, var(--body) 70%, transparent);
  }

  .text-body\/60 {
    color: color-mix(in srgb, var(--body) 60%, transparent);
  }

  .text-accent {
    color: var(--accent);
  }

  .text-error {
    color: var(--error);
  }

  .bg-accent\/10 {
    background-color: color-mix(in srgb, var(--accent) 10%, transparent);
  }

  .bg-accent\/70 {
    background-color: color-mix(in srgb, var(--accent) 70%, transparent);
  }

  .text-accent\/80 {
    color: color-mix(in srgb, var(--accent) 80%, transparent);
  }

  .shadow-soft {
    box-shadow: 0 20px 40px -24px color-mix(in srgb, var(--accent) 70%, transparent);
  }
}
